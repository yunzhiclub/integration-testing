<form class="form-inline">
  <div class="mt-3 mr-2">
    <app-project-select></app-project-select>
  </div>
  <button type="submit" class="btn btn-info mt-3"><i class="fa fas fa-search"></i>查询</button>
</form>

<div class="row mb-2 mt-2">
  <div class="col-md-6">
    <yz-size [size]="param.size" (changeSize)="onChangeSize($event)"></yz-size>
  </div>
  <div class="col-6 text-right">
    <a class="btn btn-primary" routerLink="clone">克隆</a>
    <a class="btn btn-primary ml-3" routerLink="add"><i class="fa fas fa-plus"></i>新增</a>
  </div>
</div>

<table class="table table-striped mt-2">
  <thead>
  <tr class="table-primary">
    <th>序号</th>
    <th>所属项目</th>
    <th>名称</th>
    <th>测试目的(展开是测试步骤)</th>
    <th>前置条件（展开是预期结果）</th>
    <th>操作</th>
  </tr>
  </thead>
  <tbody>
  <ng-container *ngFor="let testCase of pageData.content; index as i">
    <tr>
      <td>
        {{ i + 1 }}
        <i matTooltip="查看" (click)="toggleCollapse(testCase?.id, testCase?.isShow)"
           class="bi" [ngClass]="{'bi-caret-down-fill': testCase?.isShow, 'bi bi-caret-right-fill': !testCase?.isShow}"></i>
      </td>
      <td>{{ testCase?.project?.name }}</td>
      <td>{{ testCase?.name}}</td>
      <td>{{ testCase?.testPurpose}}</td>
      <td> {{ testCase?.preconditions}}</td>
      <td>
        <a class="text-primary mr-3" matTooltip="编辑" routerLink="edit/{{testCase?.id}}"><i class="fa fas fa-pen"></i></a>
        <a class="text-danger mr-3" matTooltip="删除" (click)="delete(testCase?.name, testCase?.id)"><i class="fa fas fa-trash"></i></a>
        <a class="text-primary mr-3" matTooltip="添加小项" routerLink="addTestItem/{{testCase?.id}}"><i class="bi bi-plus-lg"></i></a>
      </td>
    </tr>
      <ng-container *ngIf="testCase?.isShow ">
            <tr *ngFor="let testItem of testCase?.testItem" class="bg-light">
              <td></td>
              <td></td>
              <td>{{testItem?.name}} </td>
              <td>{{testItem?.steps}}</td>
              <td>{{testItem?.expectedResult}}</td>
              <td>
                <a class="text-primary mr-3" matTooltip="上移" routerLink="edit"><i class="bi bi-arrow-up"></i></a>
                <a class="text-primary mr-3" matTooltip="下移" routerLink="edit"><i class="bi bi-arrow-down"></i></a>
                <a class="text-primary mr-3" matTooltip="编辑" routerLink="editTestItem/{{testItem?.id}}"><i class="fa fas fa-pen"></i></a>
                <a class="text-danger mr-3" matTooltip="删除" (click)="deleteTestItem(testItem?.id, testItem?.name)"><i class="fa fas fa-trash"></i></a>
              </td>
            </tr>
      </ng-container>
  </ng-container>


  <tr id="" class="collapse">
    <td colspan="6">
      <div class="row mb-2 mt-2">
        <div class="col-md-6">
        </div>
        <div class="col-6 text-right">
          <a class="btn ml-3"><i class="fa fas fa-plus"></i>新增</a>
        </div>
      </div>

    </td>
  </tr>
  </tbody>
</table>

<yz-page [size]="pageData.size"
         [page]="pageData.number"
         [totalElements]="pageData.totalElements"
         (changePage)="onChangePage($event)"></yz-page>
<router-outlet></router-outlet>





